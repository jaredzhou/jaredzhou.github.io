<!doctype html><html lang=zh-cn>
<head>
<meta name=generator content="Hugo 0.88.1">
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1">
<title>Jared's Site | </title>
<meta property="og:title" content="Jared's Site | ">
<meta property="og:type" content="website">
<meta name=Keywords content>
<meta name=description content>
<meta property="og:url" content="https://jaredzhou.github.io/">
<link rel="shortcut icon" href=/favicon.ico type=image/x-icon>
<link rel=stylesheet href=/css/normalize.css>
<link rel=stylesheet href=/css/style.css>
<link rel=alternate type=application/rss+xml href=https://jaredzhou.github.io/index.xml title="Jared's Site">
<script type=text/javascript src=//cdn.bootcdn.net/ajax/libs/jquery/3.4.1/jquery.min.js></script>
</head>
<body>
<header id=header class=clearfix>
<div class=container>
<div class=col-group>
<div class=site-name>
<h1>
<a id=logo href=https://jaredzhou.github.io/>
Jared's Site
</a>
</h1>
</div>
<div>
<nav id=nav-menu class=clearfix>
<a class=current href=https://jaredzhou.github.io/>首页</a>
</nav>
</div>
</div>
</div>
</header>
<div id=body>
<div class=container>
<div class=col-group>
<div class=col-8 id=main>
<div class=res-cons>
<article class=post>
<header>
<h1 class=post-title>
<a href=https://jaredzhou.github.io/posts/mapreduce/ title=MapReduce>MapReduce</a>
</h1>
</header>
<date class="post-meta meta-date">
2021年9月25日
</date>
<div class=post-content>
系统描述 根据Google论文mapreduce开发一个简易的mapreduce系统，可以处理多个数据文件，最后生成一个结果，课程案例主要是对文本进行WordCount，首先通过map统计每个word出现的次数，然后通过reduce计算count
设计 Coordinator 协调者负责分配任务，包括map任务，reduce任务。 Worker 执行map， reduce任务， 任务通过rpc请求Cooridnator获取 Coordinator要包含错误处理，错误包括任务失败与任务缓慢，处理措施都是重试 实现 Coordinator包含两个任务队列,一个mapTasks，由输入文件数决定； 一个reduceTasks,由reduce数量决定 当worker请求任务时， Coordinator会分配一个Ready状态的任务，任务一旦分配就设置成Pending状态。 Worker完成任务后，通知Coorinator，此Task已完成, 等待1秒后继续请求下一个任务 当所有reduceTask都完成后， 整个任务完成 错误处理 当一个任务pending超过10秒后，如果状态不为Finish， 则重新设置成Ready Worker执行任务失败后，直接结束当前循环，等待下一个任务请求 任务执行成功后， Coordinator会对请求任务的worker返回Done标记， worker接收标记后退出；如果Coordinator已经退出， 则网络连接失败， Worker退出；其他情况Worker会一直循环请求任务 Worker会使用TempFile作为中间输出，当前任务完成后，Rename这些文件到正确的文件目录，所以当Worker执行失败时这些文件并不可见 流程图 ……
</div>
<p class=readmore><a href=https://jaredzhou.github.io/posts/mapreduce/>阅读全文</a></p>
</article>
<article class=post>
<header>
<h1 class=post-title>
<a href=https://jaredzhou.github.io/posts/my-first-post/ title="My First Post">My First Post</a>
</h1>
</header>
<date class="post-meta meta-date">
2021年9月8日
</date>
<div class=post-content>
Noting here……
</div>
<p class=readmore><a href=https://jaredzhou.github.io/posts/my-first-post/>阅读全文</a></p>
</article>
<article class=post>
<header>
<h1 class=post-title>
<a href=https://jaredzhou.github.io/posts/workflow/ title=任务流>任务流</a>
</h1>
</header>
<date class="post-meta meta-date">
2021年9月8日
</date>
<div class=post-content>
需求描述 由于前端展示的多样性， 需要一个可以灵活配置的Api Gateway, 这个gateway不能仅仅满足http请求都后端微服务的转发， 还必须可以定义微服务返回结果之间的组合，组合的灵活性当然是不可能达到代码的程度，但是应该可以满足常见的数据拼接，比如结果集的简单Merge，比如数据集详情扩展， 比如B接口请求依赖A接口的返回值等。 要能够请求多个接口，并且这些请求之间有一定的依赖关系， DAG是一个自然的选择， 如果把每个请求当成单个节点上的任务, 那么任务之间的依赖关系可以通过节点依赖关系表达出来， 同时没有依赖关系的任务还可以并行执行。 一个DAG可以表示一个任务流，一个任务流应该有Request， Response， 一个任务流应该有开始节点与结束节点。一个DAG应该允许节点中存在SubDAG 任务之前必须可以传递数据，我们定义A->B为B依赖A， 那么应该可以将A的执行结果传递给B。如果存在依赖关系{A->B, C->B},那么应该可以将A的结果合并C的结果。 由于在Gateway中使用， 任务的主要实现应该为 Http请求， RPCX请求， GRPC请求等， 一个问题在于如何将客户端的Http请求转化为后端服务请求，通常的情况是， 一个Http请求的query string或者body加上一些用户信息传递到后端服务，但是由于接口是从已经开发完成的系统中迁移， 所以情况可能会较为复杂。Query String, Params, Header, Body, JWT,这个都可能是参数的来源 认证与授权也可以当作节点来使用 如果任意一个节点失败， 那么请求应该是失败的， 并且返回错误信息给前端 基本设计 Request 包含http所有可能的信息， 必须包含一个requestID，假如没有就生成一个 Response 主要包含body与header， 两个部分， header中必须包含requestID 每一个接口(POST /api/username)对应一个DAG， 这个DAG可以使用JSON/YAML配置 DAG的执行应该是异步的， 每个Node可能在不同的协程中执行，DAG应该有一个Executor， 这个Executor应该负责Node的开始执行， 捕获Node执行完成信号， 并且通知所有满足依赖关系的Node继续执行，直到结束节点执行完毕。 这个Executor应该包含一个Context， 并且在所有Node中共享这个Context Node应该在一个协程池当中执行， 一个Node完成后在Context中设置完成结果，并且通过channel通知Executor ……
</div>
<p class=readmore><a href=https://jaredzhou.github.io/posts/workflow/>阅读全文</a></p>
</article>
</div>
<footer id=footer>
<div>
&copy; 2021 <a href=https://jaredzhou.github.io/>Jared's Site By </a>
</div>
<br>
<div>
<div class=github-badge>
<a href=https://gohugo.io/ target=_black rel=nofollow><span class=badge-subject>Powered by</span><span class="badge-value bg-blue">Hugo</span></a>
</div>
<div class=github-badge>
<a href=https://www.flysnow.org/ target=_black><span class=badge-subject>Design by</span><span class="badge-value bg-brightgreen">飞雪无情</span></a>
</div>
<div class=github-badge>
<a href=https://github.com/flysnow-org/maupassant-hugo target=_black><span class=badge-subject>Theme</span><span class="badge-value bg-yellowgreen">Maupassant</span></a>
</div>
</div>
</footer>
<a id=rocket href=#top></a>
<script type=text/javascript src="/js/totop.js?v=0.0.0" async></script>
</div>
<div id=secondary>
<section class=widget>
<form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1>
<input type=text name=q maxlength=20 placeholder=Search>
<input type=hidden name=sitesearch value=https://jaredzhou.github.io/>
<button type=submit class="submit icon-search"></button>
</form>
</section>
<section class=widget>
<h3 class=widget-title>最近文章</h3>
<ul class=widget-list>
<li>
<a href=https://jaredzhou.github.io/posts/mapreduce/ title=MapReduce>MapReduce</a>
</li>
<li>
<a href=https://jaredzhou.github.io/posts/my-first-post/ title="My First Post">My First Post</a>
</li>
<li>
<a href=https://jaredzhou.github.io/posts/workflow/ title=任务流>任务流</a>
</li>
</ul>
</section>
<section class=widget>
<h3 class=widget-title><a href=/categories/>分类</a></h3>
<ul class=widget-list>
</ul>
</section>
<section class=widget>
<h3 class=widget-title><a href=/tags/>标签</a></h3>
<div class=tagcloud>
</div>
</section>
<section class=widget>
<h3 class=widget-title>其它</h3>
<ul class=widget-list>
<li><a href=https://jaredzhou.github.io/index.xml>文章 RSS</a></li>
</ul>
</section>
</div>
</div>
</div>
</div>
</body>
</html>